<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MASLD/MetALD Score Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c 0%, #2a4d8e 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            width: 100%;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.25);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        header {
            background: linear-gradient(to right, #1a2a6c, #2a4d8e);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        
        header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(to right, #4CAF50, #FFC107, #F44336);
        }
        
        h1 {
            font-size: 2.4rem;
            margin-bottom: 12px;
            font-weight: 700;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.5;
        }
        
        .content {
            display: flex;
            flex-wrap: wrap;
            padding: 30px;
            gap: 30px;
        }
        
        .input-section {
            flex: 1;
            min-width: 350px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .result-section {
            flex: 1;
            min-width: 350px;
            padding: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            background: #f8f9fa;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .section-title {
            font-size: 1.4rem;
            color: #1a2a6c;
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
            font-weight: 600;
        }
        
        .input-group {
            margin-bottom: 22px;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #333;
            font-size: 0.95rem;
        }
        
        .input-hint {
            font-size: 0.8rem;
            color: #666;
            margin-top: 4px;
            font-style: italic;
        }
        
        input, select {
            width: 100%;
            padding: 14px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
            background: white;
        }
        
        input:focus, select:focus {
            border-color: #1a2a6c;
            outline: none;
            box-shadow: 0 0 0 3px rgba(26, 42, 108, 0.1);
        }
        
        .demographic-group {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .demographic-item {
            flex: 1;
        }
        
        .calculate-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(to right, #1a2a6c, #2a4d8e);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 15px;
            box-shadow: 0 4px 12px rgba(26, 42, 108, 0.3);
        }
        
        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(26, 42, 108, 0.4);
        }
        
        .calculate-btn:active {
            transform: translateY(-1px);
        }
        
        .result-box {
            width: 220px;
            height: 220px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            transition: all 0.5s;
            background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
            border: 6px solid #cccccc;
            position: relative;
            overflow: hidden;
        }
        
        .result-box::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0) 70%);
            opacity: 0;
            transition: opacity 0.5s;
        }
        
        .result-box.active::before {
            opacity: 1;
        }
        
        .score-value {
            font-size: 2.8rem;
            font-weight: 800;
            color: #333;
            z-index: 2;
        }
        
        .score-category {
            font-size: 1.2rem;
            margin-top: 12px;
            text-align: center;
            font-weight: 600;
            z-index: 2;
            padding: 0 10px;
        }
        
        .score-info {
            text-align: center;
            margin-top: 20px;
            padding: 20px;
            background-color: white;
            border-radius: 12px;
            width: 100%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-left: 4px solid #1a2a6c;
        }
        
        .score-table {
            width: 100%;
            margin-top: 25px;
            border-collapse: collapse;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .score-table th, .score-table td {
            padding: 14px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .score-table th {
            background-color: #1a2a6c;
            color: white;
            font-weight: 600;
        }
        
        .score-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .score-table tr:hover {
            background-color: #e9ecef;
        }
        
        .formula-display {
            margin-top: 25px;
            padding: 20px;
            background: linear-gradient(to right, #f0f8ff, #e6f3ff);
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
            border: 1px solid #cce5ff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .formula-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: #1a2a6c;
            font-family: 'Segoe UI', sans-serif;
        }
        
        .alcohol-info {
            background: #fff3e0;
            border: 1px solid #ffcc80;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-size: 0.9rem;
        }
        
        .alcohol-info h4 {
            color: #e65100;
            margin-bottom: 8px;
        }
        
        footer {
            padding: 25px;
            text-align: center;
            background: linear-gradient(to right, #f5f5f5, #e8e8e8);
            color: #666;
            font-size: 0.9rem;
            border-top: 1px solid #e0e0e0;
        }
        
        @media (max-width: 768px) {
            .content {
                flex-direction: column;
                padding: 20px;
            }
            
            .input-section, .result-section {
                width: 100%;
                min-width: auto;
            }
            
            .demographic-group {
                flex-direction: column;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>MASLD/MetALD Score Calculator</h1>
            <p class="subtitle">A precision medicine tool for quantifying MASLD and MetALD severity</p>
        </header>
        
        <div class="content">
            <div class="input-section">
                <h2 class="section-title">Patient Parameters</h2>
                
                <div class="demographic-group">
                    <div class="demographic-item">
                        <label for="sex">Sex</label>
                        <select id="sex">
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                        </select>
                    </div>
                    <div class="demographic-item">
                        <label for="age">Age (years)</label>
                        <input type="number" id="age" placeholder="Enter age" min="18" max="100">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="alcohol">Alcohol Consumption (g/week)</label>
                    <input type="number" id="alcohol" placeholder="Enter alcohol consumption" step="1" min="0">
                    <div class="input-hint">Excessive alcohol: ≥210 g/week (male), ≥140 g/week (female)</div>
                </div>
                
                <div class="input-group">
                    <label for="tg">Triglycerides (TG, mmol/L)</label>
                    <input type="number" id="tg" placeholder="Enter TG value" step="0.01" min="0">
                </div>
                
                <div class="input-group">
                    <label for="fpg">Fasting Plasma Glucose (FPG, mmol/L)</label>
                    <input type="number" id="fpg" placeholder="Enter FPG value" step="0.01" min="0">
                </div>
                
                <div class="input-group">
                    <label for="waist">Waist Circumference (cm)</label>
                    <input type="number" id="waist" placeholder="Enter waist circumference" step="0.1" min="0">
                </div>
                
                <div class="input-group">
                    <label for="hdl">HDL-C (mmol/L)</label>
                    <input type="number" id="hdl" placeholder="Enter HDL-C value" step="0.01" min="0">
                </div>
                
                <div class="input-group">
                    <label for="sbp">Systolic Blood Pressure (mmHg)</label>
                    <input type="number" id="sbp" placeholder="Enter SBP value" min="0" max="300">
                </div>
                
                <div class="input-group">
                    <label for="dbp">Diastolic Blood Pressure (mmHg)</label>
                    <input type="number" id="dbp" placeholder="Enter DBP value" min="0" max="200">
                </div>
                
                <div class="input-group">
                    <label>FIB-4 Calculation</label>
                    <div style="display: flex; gap: 10px; margin-top: 5px;">
                        <div style="flex: 1;">
                            <input type="number" id="ast" placeholder="AST (U/L)" step="0.1" min="0">
                        </div>
                        <div style="flex: 1;">
                            <input type="number" id="alt" placeholder="ALT (U/L)" step="0.1" min="0">
                        </div>
                        <div style="flex: 1;">
                            <input type="number" id="platelets" placeholder="Platelets (10⁹/L)" step="1" min="0">
                        </div>
                    </div>
                    <div class="input-hint">FIB-4 = (Age × AST) / (Platelets × √ALT)</div>
                </div>
                
                <div class="input-group">
                    <label for="fattyLiver">Fatty Liver (Ultrasonography)</label>
                    <select id="fattyLiver">
                        <option value="0">No</option>
                        <option value="1">Yes</option>
                    </select>
                </div>
                
                <button class="calculate-btn" id="calculate">Calculate MASLD/MetALD Score</button>
                
                <div class="formula-display">
                    <div class="formula-title">Current Formula:</div>
                    <div id="formulaDisplay">Select demographic parameters to view specific formula</div>
                </div>
                
                <div class="alcohol-info">
                    <h4>Diagnostic Criteria:</h4>
                    <p><strong>MASLD diagnosis</strong> applies to individuals without excessive alcohol consumption</p>
                    <p><strong>MetALD diagnosis</strong> applies to those with excessive alcohol consumption</p>
                    <p><em>Excessive alcohol: ≥210 g/week (male), ≥140 g/week (female)</em></p>
                </div>
            </div>
            
            <div class="result-section">
                <h2 class="section-title">Risk Assessment</h2>
                
                <div class="result-box" id="resultBox">
                    <div class="score-value" id="scoreValue">--</div>
                    <div class="score-category" id="scoreCategory">Enter parameters</div>
                </div>
                
                <div class="score-info" id="scoreInfo">
                    Please enter all patient parameters to calculate the MASLD/MetALD score
                </div>
                
                <table class="score-table">
                    <tr>
                        <th>Score Range</th>
                        <th>Clinical Interpretation</th>
                    </tr>
                    <tr>
                        <td>≥ 1.044</td>
                        <td>Indicates MASLD</td>
                    </tr>
                    <tr>
                        <td>≥ 1.274</td>
                        <td>Indicates MetALD</td>
                    </tr>
                </table>
            </div>
        </div>
        
        <footer>
            <p><strong>Disclaimer:</strong> This calculator is intended for research and clinical reference purposes only. Results should be interpreted by qualified healthcare professionals in the context of comprehensive clinical assessment.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const sexSelect = document.getElementById('sex');
            const ageInput = document.getElementById('age');
            const alcoholInput = document.getElementById('alcohol');
            const tgInput = document.getElementById('tg');
            const fpgInput = document.getElementById('fpg');
            const waistInput = document.getElementById('waist');
            const hdlInput = document.getElementById('hdl');
            const sbpInput = document.getElementById('sbp');
            const dbpInput = document.getElementById('dbp');
            const astInput = document.getElementById('ast');
            const altInput = document.getElementById('alt');
            const plateletsInput = document.getElementById('platelets');
            const fattyLiverSelect = document.getElementById('fattyLiver');
            const calculateBtn = document.getElementById('calculate');
            const scoreValue = document.getElementById('scoreValue');
            const scoreCategory = document.getElementById('scoreCategory');
            const scoreInfo = document.getElementById('scoreInfo');
            const resultBox = document.getElementById('resultBox');
            const formulaDisplay = document.getElementById('formulaDisplay');
            
            // Formula definitions
            const formulas = {
                overall: {
                    intercept: -8.656,
                    coefficients: {
                        tg: 0.428,
                        fpg: 0.230,
                        waist: 0.040,
                        hdl: -0.275,
                        map: 0.038,
                        fib4: 0.173,
                        fattyLiver: 1.544
                    },
                    display: "Score = -8.656 + 0.428×TG + 0.230×FPG + 0.040×Waist - 0.275×HDL-C + 0.038×MAP + 0.173×FIB4 + 1.544×FattyLiver"
                },
                male_lt65: {
                    intercept: -8.901,
                    coefficients: {
                        tg: 0.394,
                        fpg: 0.221,
                        waist: 0.042,
                        hdl: -0.297,
                        map: 0.039,
                        fib4: 0.172,
                        fattyLiver: 1.590
                    },
                    display: "Score = -8.901 + 0.394×TG + 0.221×FPG + 0.042×Waist - 0.297×HDL-C + 0.039×MAP + 0.172×FIB4 + 1.590×FattyLiver"
                },
                male_ge65: {
                    intercept: -7.662,
                    coefficients: {
                        tg: 0.489,
                        fpg: 0.196,
                        waist: 0.044,
                        hdl: -0.532,
                        map: 0.027,
                        fib4: 0.051,
                        fattyLiver: 1.584
                    },
                    display: "Score = -7.662 + 0.489×TG + 0.196×FPG + 0.044×Waist - 0.532×HDL-C + 0.027×MAP + 0.051×FIB4 + 1.584×FattyLiver"
                },
                female_lt65: {
                    intercept: -9.004,
                    coefficients: {
                        tg: 0.478,
                        fpg: 0.258,
                        waist: 0.039,
                        hdl: -0.141,
                        map: 0.040,
                        fib4: 0.333,
                        fattyLiver: 1.634
                    },
                    display: "Score = -9.004 + 0.478×TG + 0.258×FPG + 0.039×Waist - 0.141×HDL-C + 0.040×MAP + 0.333×FIB4 + 1.634×FattyLiver"
                },
                female_ge65: {
                    intercept: -7.167,
                    coefficients: {
                        tg: 0.475,
                        fpg: 0.203,
                        waist: 0.039,
                        hdl: -0.483,
                        map: 0.027,
                        fib4: 0.108,
                        fattyLiver: 1.362
                    },
                    display: "Score = -7.167 + 0.475×TG + 0.203×FPG + 0.039×Waist - 0.483×HDL-C + 0.027×MAP + 0.108×FIB4 + 1.362×FattyLiver"
                }
            };
            
            // Update formula display when demographics change
            function updateFormulaDisplay() {
                const sex = sexSelect.value;
                const age = parseInt(ageInput.value);
                
                let formulaKey = 'overall';
                
                if (age && sex) {
                    if (sex === 'male') {
                        formulaKey = age < 65 ? 'male_lt65' : 'male_ge65';
                    } else if (sex === 'female') {
                        formulaKey = age < 65 ? 'female_lt65' : 'female_ge65';
                    }
                }
                
                formulaDisplay.textContent = formulas[formulaKey].display;
            }
            
            sexSelect.addEventListener('change', updateFormulaDisplay);
            ageInput.addEventListener('input', updateFormulaDisplay);
            
            // Calculate FIB-4
            function calculateFIB4() {
                const age = parseInt(ageInput.value);
                const ast = parseFloat(astInput.value);
                const alt = parseFloat(altInput.value);
                const platelets = parseFloat(plateletsInput.value);
                
                if (!age || !ast || !alt || !platelets) {
                    return null;
                }
                
                // FIB-4 = (Age × AST) / (Platelets × √ALT)
                return (age * ast) / (platelets * Math.sqrt(alt));
            }
            
            // Calculate score
            calculateBtn.addEventListener('click', function() {
                const sex = sexSelect.value;
                const age = parseInt(ageInput.value);
                const alcohol = parseFloat(alcoholInput.value) || 0;
                const tg = parseFloat(tgInput.value);
                const fpg = parseFloat(fpgInput.value);
                const waist = parseFloat(waistInput.value);
                const hdl = parseFloat(hdlInput.value);
                const sbp = parseFloat(sbpInput.value);
                const dbp = parseFloat(dbpInput.value);
                const fib4 = calculateFIB4();
                const fattyLiver = parseInt(fattyLiverSelect.value);
                
                // Validate inputs
                if (!age || !tg || !fpg || !waist || !hdl || !sbp || !dbp || fib4 === null) {
                    alert('Please enter valid values for all parameters');
                    return;
                }
                
                // Calculate MAP
                const map = (sbp + 2 * dbp) / 3;
                
                // Determine which formula to use
                let formulaKey = 'overall';
                
                if (sex === 'male') {
                    formulaKey = age < 65 ? 'male_lt65' : 'male_ge65';
                } else if (sex === 'female') {
                    formulaKey = age < 65 ? 'female_lt65' : 'female_ge65';
                }
                
                const formula = formulas[formulaKey];
                
                // Calculate score
                const score = formula.intercept +
                    formula.coefficients.tg * tg +
                    formula.coefficients.fpg * fpg +
                    formula.coefficients.waist * waist +
                    formula.coefficients.hdl * hdl +
                    formula.coefficients.map * map +
                    formula.coefficients.fib4 * fib4 +
                    formula.coefficients.fattyLiver * fattyLiver;
                
                const roundedScore = Math.round(score * 1000) / 1000;
                
                // Display result
                scoreValue.textContent = roundedScore;
                
                // Determine excessive alcohol consumption
                const excessiveAlcohol = (sex === 'male' && alcohol >= 210) || 
                                       (sex === 'female' && alcohol >= 140);
                
                // Determine category and color
                let category, color, info;
                
                if (!excessiveAlcohol) {
                    // Non-excessive alcohol consumption
                    if (roundedScore < 1.044) {
                        category = 'Low Risk for MASLD';
                        color = '#4CAF50';
                        info = 'Score indicates low risk for MASLD. Maintain healthy lifestyle with regular monitoring.';
                    } else {
                        category = 'Indicates MASLD';
                        color = '#FF9800';
                        info = 'Score indicates Metabolic Dysfunction-Associated Steatotic Liver Disease. Recommend lifestyle intervention and medical follow-up.';
                    }
                } else {
                    // Excessive alcohol consumption
                    if (roundedScore < 1.274) {
                        category = 'Low Risk for MetALD';
                        color = '#FFC107';
                        info = 'Score indicates low risk for MetALD despite excessive alcohol consumption. Alcohol reduction recommended.';
                    } else {
                        category = 'Indicates MetALD';
                        color = '#F44336';
                        info = 'Score indicates Metabolic Dysfunction and Alcohol-Associated Liver Disease. Recommend alcohol reduction and medical evaluation.';
                    }
                }
                
                scoreCategory.textContent = category;
                scoreInfo.textContent = info;
                resultBox.style.background = `linear-gradient(135deg, ${color}20, ${color}60)`;
                resultBox.style.border = `6px solid ${color}`;
                resultBox.classList.add('active');
                
                // Add alcohol consumption info
                if (alcohol > 0) {
                    const alcoholStatus = excessiveAlcohol ? 'Excessive' : 'Non-excessive';
                    scoreInfo.innerHTML += `<br><br><strong>Alcohol consumption:</strong> ${alcohol} g/week (${alcoholStatus})`;
                }
            });
            
            // Initialize formula display
            updateFormulaDisplay();
        });
    </script>
</body>
</html>